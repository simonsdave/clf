configure_clf()
{

    if [ ! -f "$PWD/.801dbe4659a641739cbe94fcf0baab03" ]; then
        echo "Must source this script from clf's root directory"
        return 1
    fi

    #
    # cd /tmp
    # curl -O http://chromedriver.storage.googleapis.com/2.9/chromedriver_mac32.zip
    # unzip chromedriver_mac32.zip
    # sudo mv chromedriver /usr/bin/.
    # sudo chown root:wheel /usr/bin/chromedriver
    #
    if [ "$(which chromedriver)" == "" ]; then
        echo "chromedriver not installed (sb in /usr/bin on OS X)"
        return 1
    fi

    #
    # clf uses boto and requires credentials are listed in ~/.boto
    #
    if [ ! -r ~/.boto ]; then
        echo "could not find boto config file ~/.boto"
        return 1
    fi

    #
    # on 12 Mar '14 installed "Apple's Command Line Tools (OS X Mavericks)
    # for Xcode - March 2014" and attempted to source bin/cfg4dev - this
    # failed with following error:
    #
    #   clang: error: unknown argument: '-mno-fused-madd' [-Wunused-command-line-argument-hard-error-in-future]
    #
    # initial solution is described in
    # http://stackoverflow.com/questions/22313407/clang-error-unknown-argument-mno-fused-madd-psycopg2-installation-failure
    # which says to set the CFLAGS & CPPFLAGS environment variables
    # as is done below
    #
    if [ "$(uname -s)" == "Darwin" ]; then
        export CFLAGS=-Qunused-arguments
        export CPPFLAGS=-Qunused-arguments
    fi

    if [ -d "$PWD/env" ]; then
        source "$PWD/env/bin/activate"
    else
        virtualenv env
        source "$PWD/env/bin/activate"
        pip install --requirement "$PWD/requirements.txt"
    fi
    export PATH=$PATH:"$PWD/bin"
    export PYTHONPATH="$PWD"

    if [ "" != "`which Xvfb`" ]; then
        if [ "" == "$DISPLAY" ]; then
            export DISPLAY=:99
        fi
        if [ "0" == "`ps aux | grep \[X\]vfb | wc -l | sed -e "s/[[:space:]]//g"`" ]; then
            Xvfb $DISPLAY -ac -screen 0 1280x1024x24 >& /dev/null &
        fi
    fi

    return 0
}

configure_clf
